<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Graphing Example</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/graph.css">
    </head>
    <body>

		<section class="chart-holder">
			<!-- because of the way jQuery appends SVG objects to the DOM, fopr this to render, it needs to have an idle svg container on load.
			this cannot be programattically added. -->
			<svg class="chart" version="1.1" ></svg>
		</section>



		<script src="js/jquery-1.10.2.min.js"></script> <!-- jQuery dependency -->
		<script src="js/seriesGraph.js"></script> <!-- seriesGraph dependency -->
		<script>
			/*
				Dummy data which will eventually reflect Rapid Report objects.
				The Series class currently expects the data to have a key and value params
			*/
			var dataSet = [
				{
					key: '2014-04-29',
					value: 0
				},
				{
					key: '2014-04-30',
					value: 1
				},
				{
					key: '2014-05-01',
				  	value: 5
				},
				{
					key: '2014-05-02',
					value: 4
				},
				{
					key: '2014-05-03',
					value: 9
				},
				{
					key: '2014-05-04',
					value: 14
				},
				{
					key: '2014-05-05',
					value: 18
				},
				{
					key: '2014-05-06',
					value: 20
				},
				{
					key: '2014-05-07',
					value: 25
				},
				{
					key: '2014-05-04',
					value: 14
				},
				{
					key: '2014-05-08',
					value: 21
				},
				{
					key: '2014-05-04',
					value: 14
				},
				{
					key: '2014-05-04',
					value: 14
				},
				{
					key: '2014-05-04',
					value: 14
				},
				{
					key: '2014-05-09',
					value: 22
				},
				{
					key: '2014-05-10',
					value: 10
				},
				{
					key: '2014-05-11',
					value: 20
				},
				{
					key: '2014-05-12',
					value: 25
				},
				{
					key: '2014-05-13',
					value: 16
				},
				{
					key: '2014-05-07',
					value: 25
				},
				{
					key: '2014-05-08',
					value: 21
				},
				{
					key: '2014-05-09',
					value: 22
				},
				{
					key: '2014-05-10',
					value: 10
				},
				{
					key: '2014-05-11',
					value: 20
				},
				{
					key: '2014-05-12',
					value: 25
				},
				{
					key: '2014-05-13',
					value: 16
				},
				{
					key: '2014-05-10',
					value: 10
				}

			];

			var dataSet2 = [
				{
					key: '2014-05-01',
					value: 3
				},
				{
					key: '2014-05-02',
					value: 7
				},
				{
					key: '2014-05-03',
					value: 3
				},
				{
					key: '2014-05-04',
					value: 20
				},
				{
					key: '2014-05-05',
					value: 15
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-07',
					value: 4
				},
				{
					key: '2014-05-01',
					value: 3
				},
				{
					key: '2014-05-02',
					value: 7
				},
				{
					key: '2014-05-04',
					value: 20
				},
				{
					key: '2014-05-05',
					value: 15
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-07',
					value: 4
				},
				{
					key: '2014-05-03',
					value: 3
				},
				{
					key: '2014-05-04',
					value: 17
				},
				{
					key: '2014-05-05',
					value: 15
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-04',
					value: 20
				},
				{
					key: '2014-05-05',
					value: 15
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-07',
					value: 4
				},
				{
					key: '2014-05-07',
					value: 4
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-07',
					value: 4
				},
				{
					key: '2014-05-03',
					value: 3
				},
				{
					key: '2014-05-04',
					value: 17
				},
				{
					key: '2014-05-05',
					value: 15
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-04',
					value: 20
				},
				{
					key: '2014-05-05',
					value: 15
				},
				{
					key: '2014-05-06',
					value: 5
				},
				{
					key: '2014-05-07',
					value: 4
				},
				{
					key: '2014-05-07',
					value: 4
				}
			];

			var dataSet3 = [
				{
					key: '2014-05-01',
					value: 20
				},
				{
					key: '2014-05-02',
					value: 24
				},
				{
					key: '2014-05-03',
					value: 22
				},
				{
					key: '2014-05-04',
					value: 18
				}
			];

			// defines the container to the Chart object, necessary for making the descendant svg object responsive to the container.
			// this allows the developer to only size the wrapping holder, and that wil define the chart's width/height
			var $chartHolder = $('.chart-holder');
			var $svg = $('.chart'); // main svg container. TODO: eventually have this generated by the Chart class.
			// custom formatting functions for the Axis display. Eventually these will be used to add 15% value on top and bottom, or do other customized Axis scaling
			var zeroFunc = function() { return 0; } // will always return zero
			var sameFunc = function(v) { return v; } // simply returns the number that's passed through (default)

			/*
				Series

				The Series object defines the data set and the axis that will represent it once plotted to the graph.
				It also allows you to configure the type of graph, and classes for further styling.

			 	data: The series needs the dataSet defined, there is 1:1 relationship of data to series.
				type: The Series object defines the type of chart that will be rendered (line | bar)
				className: when rendered, this classname is applied to the SVG objects, for styling later.
				axis: the config sent to the axis class instantiation which is married to the Series object.
				 	TODO: instantiate this outside of the Series declaration, and just pass in the Axis object
					position: rendering the axis on the left, or right, or top -- currently only left works.
					unique: will determine if this axis should be rendered separately from other axises.
					line_count: the number of ticks that will display on the chart.
					start: a Function that will accept the highest data value and transform it
			 		end: a Function that will accept the lowest data value and transform it
				TODO: Eventually, if no axis config is passed through, an axis wont render at all, right now that doesnt work.
			 */
			var series = new Series({
				data: dataSet,
				type: 'line',
				className: 'series1',
				axis: {
					position: 'left',
					unique: true,
					line_count: 10,
					start: zeroFunc,
					end: sameFunc
				}
			});
			var series2 = new Series({
				data: dataSet2,
				type: 'bar',
				className: 'series2',
				axis: {
					position: 'left',
					unique: true,
					line_count: 5,
					start: zeroFunc,
					end: sameFunc
				}
			});
			/*
			var series3 = new Series({
				data: dataSet3,
				type: 'bar',
				className: 'series3'
			});
			*/


			/*
				Graph

				Graph ingests a collection of Series objects, each to be rendered on the graph composition.

				series: Array of Series objects, the order of this array actually reflects the layering priority of the line or bar graphs
				$container: jQuery object that represents the svg container. This allows for better page responsiveness, as the sibling svg object will respond to it's size.
				labelSpacing: Properties top, right, bottom, and left which represent the margins given to the graph, mainly room for axis and titles.
				TODO: Would be nice to have the needed space auto calculated.
			 */
			var graph = new Graph({
				series : [series, series2], //, series3],
				$container : $chartHolder,
				labelSpacing : {
					top: 10,
					right: 50,
					bottom: 20,
					left: 100
				},
				rePaintOnResize: true
			});

			// Adding the Jquery Graph object to the svg container
			$svg.html(graph.get$Root());
		</script>


		<!--
			TODO: modularize the use of gradients/patterns so that these don't muck up the HTML. This can even be abstracted out into it's own page template of JS file.
			To currently utilize the pattern definitions in SVG renderings, they need to be defined within the <svg> tag.
		-->
		<svg>
			<defs>
				<pattern id="MyGradient" patternUnits="userSpaceOnUse" x="0" y="0" width="15" height="15" fill="rgba(0,0,0,.5)">
					<!-- Create path for individual piece of pattern. -->
					<rect x=0 y=0 width=15 height=15 fill="rgba(0,150,0,.8)" />
					<g transform="rotate(45 0 0)">
						<rect x=0 y=0 width=15 height=15 />
					</g>
				</pattern>
			</defs>
		</svg>

	</body>
</html>
